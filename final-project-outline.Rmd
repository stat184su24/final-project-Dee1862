---
title: "Initial EDA Basic Outline"
author: "Deekshith Reddy Bhoomireddy"
output: html_notebook
---


## Research Question: 

What is the relationship between the age and various performance metrics (awards, batting averages, strike rate, total runs, number of 50s and number of 100s) of T20I cricket players under the age of 35?

```{r}
#The required libraries
library(dplyr)
library(ggplot2)
library(gridExtra)
library(tidyverse)

```


## Data Intake and Processing:
In this section, we will import the data sets (downloaded from <https://data.world/raghav333/cricket-players-espn>). These data sets contain comprehensive information on cricket players information scraped from <https://www.espncricinfo.com/cricketers>, a well-known and reputable source for cricket match statistics. These statistics and data sets are accurate and up-to-date. However, the data set we will be using is somewhat old, so it does not contain statistics from recent years. 

After importing the data sets, we will inspect the data sets and compare them to create a new filtered data set. The purpose of these data sets is to analyze how age affects the player performance across various metrics. This analysis and its outcomes are valuable to team selectors to make efficient decisions in matters related to player selection for the T20I team.

```{r}
# Import the data sets
old_cricket_data <- read_csv("cricket_data.csv", show_col_types = FALSE)
cricket_data <- read_csv("SuperCleaned.csv", show_col_types = FALSE)

#Inspect the data sets
glimpse(old_cricket_data)
View(old_cricket_data)

glimpse(cricket_data)
View(cricket_data)

# Number of unique countries in the "cricket_data"
num_countries <- cricket_data %>%
  filter(!is.na(COUNTRY)) %>%
  summarize(num_countries = n_distinct(COUNTRY)) %>%
  pull(num_countries)

if (num_countries_old == num_countries) {
  # Prints the number of countries in both data sets
  cat("Number of countries in both the data sets:", num_countries_old, "\n")
} else{
  # Prints the number of countries in "old_cricket_data"
  cat("Number of countries in the old dataset:", num_countries_old, "\n")

  # Prints the number of countries in "cricket_data"
  cat("Number of countries in the new dataset:", num_countries, "\n")
}


```

## Data Points Examination:
The data sets were scraped and uploaded on <https://data.world/raghav333/cricket-players-espn>, 5 years ago, and also provide very useful information on 90308 male cricket players from 105 countries. Both the data sets contain detailed information about each cricketer, ranging from their age to specific performance metric (like their strike rate, batting average, and many more).

- Number of data points: The "cricket_data.csv" file has data related to 90308 players and 181 variables. Whereas, the "SuperCleaned.csv" file has data related to 90308 players and 177 columns. The data sets are . 

- Representation of countries: Both the data sets represent cricketers from 105 countries, ensuring a diverse sample of international players. This wide and diverse representation allows for a comprehensive analysis of cricket performance across different regions.

- Missing data points: Both the data sets contain alot of missing data making it extremely challenging and hard to clean. Missing data points are mainly common in columns related to performance metrics. These gaps could be possibly due to incomplete Records and unavailable statistics as for some players certain performance metrics might not have been recorded or reported, especially for those who played in earlier eras or less popular or less documented matches.



## Data Wrangling:
In this section, we will select, merge, clean and filter the data. This includes selecting relevant columns from both the imported data sets, merging the two data sets, converting required columns to numeric data types, and filtering the data to include only players who are 35 years or younger (because the average retirement age of a T20I cricketer is around 35 years).

```{r}

# Select relevant columns
super_cleaned_data <- cricket_data %>% select(NAME, AWARDS, BATTING_T20Is_100, BATTING_T20Is_50, BATTING_T20Is_Ave, BATTING_T20Is_Runs, BATTING_T20s_Ave, BATTING_T20Is_SR, Age)
cricket_data_role <- old_cricket_data %>% select(NAME, `Playing role`)

# Merge the data sets
merged_data <- 
  super_cleaned_data %>%
  inner_join(cricket_data_role, by = "NAME")

# Cleaning the data set
cricket_data_clean <- 
  merged_data %>%
  select(c(NAME, Age, AWARDS, BATTING_T20Is_100, BATTING_T20Is_50, BATTING_T20Is_Ave, BATTING_T20Is_Runs, BATTING_T20s_Ave, BATTING_T20Is_SR, `Playing role`)) %>%
  filter(!is.na(BATTING_T20Is_Ave) & !is.na(Age) & !is.na(BATTING_T20Is_SR) & !is.na(BATTING_T20Is_Runs) & !is.na(BATTING_T20Is_100) & !is.na(BATTING_T20Is_50)) %>%
  mutate(
    Age = as.numeric(Age),
    Total_Runs = as.numeric(BATTING_T20Is_Runs),
    BATTING_T20Is_Ave = as.numeric(BATTING_T20Is_Ave),
    BATTING_T20Is_SR = as.numeric(BATTING_T20Is_SR),
    BATTING_T20Is_100 = as.numeric(BATTING_T20Is_100),
    BATTING_T20Is_50 = as.numeric(BATTING_T20Is_50)
  )

# Filter the new data to include only cricketers who are 35 years old or younger
cricket_data_upto_35 <- cricket_data_clean %>%
  filter(Age <= 35)

```



## Data Visualization:
In this section, we will create various visualizations to explore the relationship between age and various performance metrics in T20I cricket players under the age of 35. All the various performace metrics are the variables:
- Age: A numeric variable which represents the age of the players.
- AWARDS: A list which consists of all the awards received by each player in T20I matches. 
- BATTING_T20Is_Ave: A numeric variable which represents the batting average of each player in T20I matches.
- BATTING_T20Is_SR: A numeric variable which represents the strike rate of each player in T20I matches.
- Total_Runs: A numeric variable which represents the total number of runs of each player in T20I matches.
- BATTING_T20Is_50: A numeric variable which represents the total number of half-centuries of each player in T20I matches.
- BATTING_T20Is_100: A numeric variable which represents the total number of centuries of each player in T20I matches.
- Playing role: A categorical variable which represents the primary role of the player in the team.



- Bar graph: Player role vs Total Number of Awards
In this section, we will plot a bar graph to show the relationship between the player role and total number of awards of a T20I cricket player.

```{r}
#Filter the data set for the awards and the player role.
awards_by_player_role <- cricket_data_upto_35 %>%
  filter(!is.na(NAME) & !is.na(`Playing role`) & !is.na(AWARDS)) %>%
  filter(!`Playing role` %in% c('Batsman, Batsman', 'Wicketkeeper, Wicketkeeper')) %>%
  group_by(`Playing role`) %>%
  summarise(Total_Awards = n()) %>%
  arrange(desc(Total_Awards))

# Creates the bar chart.
bar_player_role_vs_awards <- 
  awards_by_player_role %>%
  ggplot(aes(x = reorder(`Playing role`, Total_Awards), y = Total_Awards)) +
  geom_bar(stat = "identity", fill = 'skyblue') +
  labs(title = "Player Role vs Number of Awards",
       x = "Player Role",
       y = "Total Awards") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Displays the plot.
bar_player_role_vs_awards

```



- Bar graph: Age vs Total Number of Awards
In this section, we will plot a bar graph to show the relationship between the age and total number of awards of a T20I cricket player.

```{r}

#Filter the data set for the awards and age.
awards_by_age_group_upto_35 <- 
  cricket_data_upto_35 %>%
  filter(!is.na(NAME) & !is.na(Age) & !is.na(AWARDS)) %>%
  group_by(Age_Group = cut(Age, breaks = seq(20, 35, by = 3))) %>%
  summarise(Total_Awards = n())

# Creates the bar chart.
bar_age_vs_awards <- 
  awards_by_age_group_upto_35 %>%
  ggplot(aes(x = Age_Group, y = Total_Awards)) +
  geom_bar(stat = "identity", fill = 'skyblue') +
  labs(title = "Age Group vs Number of Awards",
       x = "Age Group",
       y = "Total Awards")

# Displays the plot.
bar_age_vs_awards

```



- Scatter plot: Age vs Batting Average
In this section, we will plot a scatter plot to show the relationship between the age and batting average of a T20I cricket player.

```{r}
# Creates the scatter plot.
scatter_age_vs_avg <- 
  cricket_data_upto_35 %>%
  ggplot(aes(x = Age, y = BATTING_T20Is_Ave)) +
  geom_point(color = 'purple') +
  geom_smooth(method = "lm", formula = y ~ x, col = "red") +
  labs(title = "Age vs Batting Average",
       x = "Age",
       y = "Batting Average")

# Displays the plot.
scatter_age_vs_avg


```



- Scatter plot: Age vs Strike Rate
In this section, we will plot a scatter plot to show the relationship between the age and strike rate of a T20I cricket player.

```{r}
# Creates the scatter plot.
scatter_age_vs_sr <- 
  cricket_data_upto_35 %>%
  ggplot(aes(x = Age, y = BATTING_T20Is_SR)) +
  geom_point(color = 'purple') +
  geom_smooth(method = "lm", formula = y ~ x, col = "red") +
  labs(title = "Age vs Strike Rate",
       x = "Age",
       y = "Strike Rate")

# Displays the plot.
scatter_age_vs_sr


```



- Scatter plot: Age vs Total Runs
In this section, we will plot a scatter plot to show the relationship between the age and total runs of a T20I cricket player.

```{r}
# Creates the scatter plot.
scatter_age_vs_runs <- 
  cricket_data_upto_35 %>%
  ggplot(aes(x = Age, y = Total_Runs)) +
  geom_point(color = 'purple') +
  geom_smooth(method = "lm", formula = y ~ x, col = "red") +
  labs(title = "Age vs Total Runs",
       x = "Age",
       y = "Total Runs")

# Displays the plot.
scatter_age_vs_runs


```



- Scatter plot: Age vs Number of 50s
In this section, we will plot a scatter plot to show the relationship between the age and number of 50s of a T20I cricket player.

```{r}
# Creates the scatter plot.
scatter_age_vs_50s <- 
  cricket_data_upto_35 %>%
  ggplot(aes(x = Age, y = BATTING_T20Is_50)) +
  geom_point(color = 'purple') +
  geom_smooth(method = "lm", formula = y ~ x, col = "red") +
  labs(title = "Age vs Number of 50s",
       x = "Age",
       y = "Total 50s")

# Displays the plot.
scatter_age_vs_50s


```



- Scatter plot: Age vs Number of 100s
In this section, we will plot a scatter plot to show the relationship between the age and number of 100s of a T20I cricket player.

```{r}
# Creates the scatter plot.
scatter_age_vs_100s <- 
  cricket_data_upto_35 %>%
  ggplot(aes(x = Age, y = BATTING_T20Is_100)) +
  geom_point(color = 'purple') +
  geom_smooth(method = "lm", formula = y ~ x, col = "red") +
  labs(title = "Age vs Number of 100s",
       x = "Age",
       y = "Total 100s")

# Displays the plot.
scatter_age_vs_100s


```



## Combined Visualization:
In this section, we will display all the graphs (or visualizations) together. This combined visualization will help us in comparing various performance metrics against age.

```{r}
# Display all the plots together.
grid.arrange(
  scatter_age_vs_avg, scatter_age_vs_sr, scatter_age_vs_runs,
  scatter_age_vs_50s, scatter_age_vs_100s,
  nrow = 3
)

grid.arrange(
  bar_age_vs_awards, bar_player_role_vs_awards,
  nrow = 1
)
```


## Conclusion:
In this analysis, we investigated the relationship between age and various performance metrics of T20I cricket player who are 35 years old or younger.From the visualization, it can be concluded that:

- Age vs Batting Average, Age vs Total Runs and Age vs Number of 50s: 
The scatter plot of age versus batting average, total runs and number of 50s demonstrates a slight positive trend. This suggests that the batting averages, total runs and number of 50s of the players increases as they get older. However, it is important to note that the trend is positive and not steep, meaning that their are incremental improvements rather than drastic changes with age.

- Age vs Strike Rate:
The scatter plot of age vs strike rate also shows a positive trend. This indicates that older players tend to have more strike rate. Therefore, older players may have higher strike rate due to their high experience in reading the bowlers and the field conditions, leading to more effective shots and scores.


- Age vs Number of 100s: 
The scatter plot of age vs number of 100s shows a trend line which appers to have a slope close to zero. This indicates that the number of 100s scored is relatively consistent across all the age groups less than or equal to 35 years. From this we can also interpret that as the age of the players increases, their experience and scores increases but their ability to convert these experience and scores into centuries almost stays the same.

- Age vs Number of Awards: 
The bar graph of the age vs number of awards indicates that cricketers between the age group of 26 to 29 years receive more awards than any other age groups equal to or less than 35. Meaning that this age range might be the peak period of many of the cricketers, leading to prestigious awards and recognition.

-Player role vs Total Awards:
The bar graph of the "Player role vs Total Awards" indicates that bowlers get the most number of awards and the bowling all-rounders (meaning all-rounders who are good at bowling) get the least number of awards. This graph emphasizes the significant impact of bowlers on T20I matches, the importance of diverse roles and the various contributions required for a team's success in T20I. 


To summarize, we can conclude that age positively impacts certain performance metrics like batting averages, strike rates, total runs and number of 50s. These improvements and positive impact can be attributed to experience and developing skills which come with playing for many years in international cricket. However, the ability to score centuries in T20Is remains relatively unaffected by age, highlighting the difficult in achieving such milestones. Moreover, the impressive phase of the career of a cricketer is between 26 to 29 years. Additionally, we can also interpret that the bowlers have a significant impact on the T20I match, so creating a balanced team using such insights is the first and key step of success in a T20I match. Such insights are invaluable for the T20I selection team of every team in understanding the secrets of forming a balanced and powerful team of T20I players
